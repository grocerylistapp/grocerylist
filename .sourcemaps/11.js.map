{"version":3,"sources":["../../src/pages/shop-buddy-list/shop-buddy-list.module.ts","../../src/pages/shop-buddy-list/shop-buddy-list.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ShopBuddyListPage } from './shop-buddy-list';\n\n@NgModule({\n  declarations: [\n    ShopBuddyListPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ShopBuddyListPage),\n  ],\n})\nexport class ShopBuddyListPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/shop-buddy-list/shop-buddy-list.module.ts","import { Component, OnInit } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { AuthServiceProvider } from '../../providers/auth-service/auth-service';\nimport { DataServiceProvider } from '../../providers/data-service/data-service';\nimport { User } from 'firebase/app';\nimport { Profile } from '../../models/profile/profile';\nimport { Subscription } from 'rxjs/Subscription';\nimport { FirebaseListObservable, AngularFireDatabase, FirebaseObjectObservable } from 'angularfire2/database';\n\n/**\n * Generated class for the ShopBuddyListPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-shop-buddy-list',\n  templateUrl: 'shop-buddy-list.html',\n})\nexport class ShopBuddyListPage {\n\n  userProfile: Profile;\n  private authenticatedUser : User;\n  private inviteListRef$ : FirebaseListObservable<Notification[]>\n  private userBuddyListObj: FirebaseObjectObservable<Profile>;\n  private buddyBuddyListObj: FirebaseObjectObservable<Profile>;\n\n  buddyListPending: Array<any>;\n  buddyListCompleted: Array<any>;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, private data: DataServiceProvider, private auth: AuthServiceProvider,\n    private db : AngularFireDatabase) {\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad ShopBuddyListPage');\n  }\n\n  ngOnInit(): void {\n    this.auth.getAuthenticatedUser().subscribe((user: User) => {\n      this.authenticatedUser = user;\n      //this.buddyList = [];\n      this.inviteListRef$ = this.db.list(`/grocerybuddylist/${user.uid}`);\n      this.inviteListRef$.subscribe( inviteList  => {\n        console.log(inviteList);\n        inviteList.forEach((invite) => {\n          let profileData = this.db.object(`/profiles/${invite['$key']}`);\n          //this.buddyList = [];\n          this.buddyListPending  = [];\n          this.buddyListCompleted  = [];\n          profileData.subscribe((buddyProfile) => {\n            if(invite['status'] == 'pending') {\n              console.log(this.buddyListPending)\n              this.buddyListPending.push({\n                buddy: buddyProfile,\n                status: invite['status']\n              });\n            }\n            else if(invite['status'] == 'completed') {\n              console.log(this.buddyListCompleted)\n              this.buddyListCompleted.push({\n                buddy: buddyProfile,\n                status: invite['status']\n              });\n            }\n          });\n\n        });\n        //console.log(this.buddyList);\n      });\n      this.data.getProfile(user).subscribe(profile => {\n        this.userProfile = <Profile>profile.val();\n      });\n    })\n  }\n\n  acceptInvite(notification) {\n    console.log(notification);\n    this.userBuddyListObj = this.db.object(`/grocerybuddylist/${this.authenticatedUser.uid}`);\n    this.buddyBuddyListObj = this.db.object(`/grocerybuddylist/${notification.buddy['$key']}`);\n\n    this.userBuddyListObj.$ref.child(notification.buddy['$key']).update({\n      status: 'completed'\n    });\n    this.buddyBuddyListObj.$ref.child(this.authenticatedUser.uid).set({\n      status: 'completed'\n    });\n    this.buddyListCompleted.forEach((invite) => {\n          if(invite.buddy['$key'] === notification.buddy['$key']) {\n            invite.buddy.status = 'completed';\n            invite.status = 'completed';\n          }\n    });\n\n  }\n\n  declineInvite(notification) {\n    console.log(notification);\n    this.userBuddyListObj = this.db.object(`/grocerybuddylist/${this.authenticatedUser.uid}`);\n    this.userBuddyListObj.$ref.child(notification['$key']).remove();\n  }\n\n  navigateToAddBuddy(){\n    this.navCtrl.push('AddBuddyPage',{ buddyStatus: \"userProfile\"});\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/shop-buddy-list/shop-buddy-list.ts"],"sourceRoot":""}