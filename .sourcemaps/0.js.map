{"version":3,"sources":["../../src/pages/shop-buddy-list/shop-buddy-list.module.ts","../../src/pages/shop-buddy-list/shop-buddy-list.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ShopBuddyListPage } from './shop-buddy-list';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ShopBuddyListPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ShopBuddyListPage),\r\n  ],\r\n})\r\nexport class ShopBuddyListPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/shop-buddy-list/shop-buddy-list.module.ts","import { Component, OnInit } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { AuthServiceProvider } from '../../providers/auth-service/auth-service';\r\nimport { DataServiceProvider } from '../../providers/data-service/data-service';\r\nimport { User } from 'firebase/app';\r\nimport { Profile } from '../../models/profile/profile';\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport { FirebaseListObservable, AngularFireDatabase, FirebaseObjectObservable } from 'angularfire2/database';\r\n\r\n/**\r\n * Generated class for the ShopBuddyListPage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-shop-buddy-list',\r\n  templateUrl: 'shop-buddy-list.html',\r\n})\r\nexport class ShopBuddyListPage {\r\n\r\n  userProfile: Profile;\r\n  private authenticatedUser : User;\r\n  private inviteListRef$ : FirebaseListObservable<Notification[]>\r\n  private userBuddyListObj: FirebaseObjectObservable<Profile>;\r\n  private buddyBuddyListObj: FirebaseObjectObservable<Profile>;\r\n\r\n  buddyListPending: Array<any> = [];\r\n  buddyListCompleted: Array<any> = [];\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, private data: DataServiceProvider, private auth: AuthServiceProvider,\r\n    private db : AngularFireDatabase) {\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad ShopBuddyListPage');\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.auth.getAuthenticatedUser().subscribe((user: User) => {\r\n      this.authenticatedUser = user;\r\n      //this.buddyList = [];\r\n      this.inviteListRef$ = this.db.list(`/grocerybuddylist/${user.uid}`);\r\n      this.inviteListRef$.subscribe( inviteList  => {\r\n        console.log(inviteList);\r\n        inviteList.forEach((invite) => {\r\n          let profileData = this.db.object(`/profiles/${invite['$key']}`);\r\n          //this.buddyList = [];\r\n          this.buddyListPending  = [];\r\n          this.buddyListCompleted  = [];\r\n          profileData.subscribe((buddyProfile) => {\r\n            if(invite['status'] == 'pending') {\r\n              console.log(this.buddyListPending)\r\n              this.buddyListPending.push({\r\n                buddy: buddyProfile,\r\n                status: invite['status']\r\n              });\r\n            }\r\n            else if(invite['status'] == 'completed') {\r\n              console.log(this.buddyListCompleted)\r\n              this.buddyListCompleted.push({\r\n                buddy: buddyProfile,\r\n                status: invite['status']\r\n              });\r\n            }\r\n          });\r\n\r\n        });\r\n        //console.log(this.buddyList);\r\n      });\r\n      this.data.getProfile(user).subscribe(profile => {\r\n        this.userProfile = <Profile>profile.val();\r\n      });\r\n    })\r\n  }\r\n\r\n  acceptInvite(notification) {\r\n    console.log(notification);\r\n    this.userBuddyListObj = this.db.object(`/grocerybuddylist/${this.authenticatedUser.uid}`);\r\n    this.buddyBuddyListObj = this.db.object(`/grocerybuddylist/${notification.buddy['$key']}`);\r\n\r\n    this.userBuddyListObj.$ref.child(notification.buddy['$key']).update({\r\n      status: 'completed'\r\n    });\r\n    this.buddyBuddyListObj.$ref.child(this.authenticatedUser.uid).set({\r\n      status: 'completed'\r\n    });\r\n    this.buddyListCompleted.forEach((invite) => {\r\n          if(invite.buddy['$key'] === notification.buddy['$key']) {\r\n            invite.buddy.status = 'completed';\r\n            invite.status = 'completed';\r\n          }\r\n    });\r\n\r\n  }\r\n\r\n  declineInvite(notification) {\r\n    console.log(notification);\r\n    this.userBuddyListObj = this.db.object(`/grocerybuddylist/${this.authenticatedUser.uid}`);\r\n    this.userBuddyListObj.$ref.child(notification['$key']).remove();\r\n  }\r\n\r\n  navigateToAddBuddy(){\r\n    this.navCtrl.push('AddBuddyPage',{ buddyStatus: \"userProfile\"});\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/shop-buddy-list/shop-buddy-list.ts"],"sourceRoot":""}