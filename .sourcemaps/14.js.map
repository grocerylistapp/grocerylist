{"version":3,"sources":["../../src/pages/my-previous-trip/my-previous-trip.module.ts","../../src/pages/my-previous-trip/my-previous-trip.ts"],"names":[],"mappings":"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","file":"14.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { MyPreviousTripPage } from './my-previous-trip';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    MyPreviousTripPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(MyPreviousTripPage),\r\n  ],\r\n})\r\nexport class MyPreviousTripPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my-previous-trip/my-previous-trip.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ActionSheetController, LoadingController } from 'ionic-angular';\r\n\r\nimport { AddShoppingPage } from \"../add-shopping/add-shopping\";\r\nimport { EditShoppingItemPage } from \"../edit-shopping-item/edit-shopping-item\";\r\nimport { ShoppingItem } from \"../../models/shopping-item/shopping-item.interface\";\r\nimport { } from \"../edit-shopping-item/edit-shopping-item\";\r\nimport { FirebaseListObservable, AngularFireDatabase, FirebaseObjectObservable } from 'angularfire2/database';\r\nimport { User } from 'firebase/app';\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport { AuthServiceProvider } from '../../providers/auth-service/auth-service';\r\nimport { DataServiceProvider } from '../../providers/data-service/data-service';\r\nimport { Store } from '../../models/store/store';\r\n\r\n/**\r\n * Generated class for the MyPreviousTripPage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-my-previous-trip',\r\n  templateUrl: 'my-previous-trip.html',\r\n})\r\nexport class MyPreviousTripPage {\r\n  \r\n    shoppingListRef$: FirebaseListObservable<ShoppingItem[]>;\r\n    previousTripRef$: FirebaseListObservable<Store[]>;\r\n    public previousListArray: Array<any> = [];\r\n  \r\n    private authenticatedUser: User;\r\n    private authenticatedUser$: Subscription;\r\n    private loading;\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, private db: AngularFireDatabase,\r\n    private actionSheetCntrl: ActionSheetController, private auth: AuthServiceProvider, private data: DataServiceProvider,\r\n    public loadingCtrl: LoadingController) {\r\n    \r\n    this.loading = this.loadingCtrl.create({\r\n      content: 'Please wait...'\r\n    });\r\n    this.loading.present();\r\n\r\n    try {\r\n      console.log(\"Came to nexttrip oninnit\");\r\n      this.authenticatedUser$ = this.auth.getAuthenticatedUser().subscribe((user: User) => {\r\n        this.authenticatedUser = user;\r\n        this.initFirebase();\r\n        console.log(`nexttrip got user1 ${this.authenticatedUser.uid}`);\r\n      })\r\n    } catch (e) {\r\n      // console.error(e);\r\n    }\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad MyPreviousTripPage');\r\n  }\r\n\r\n  initFirebase() {\r\n    let self = this;\r\n    this.previousTripRef$ = this.db.list(`/previoustrip/${this.authenticatedUser.uid}`);\r\n    this.previousTripRef$.$ref.once(\"value\", function (snapshot) {\r\n      snapshot.forEach(snaps => {\r\n        let previousArray = [];\r\n        previousArray['date'] = self.getDateInFormat(snaps.key);\r\n        let storeArray: Array<any> = [];\r\n        snaps.child('/').forEach(itemTmp => {          \r\n          itemTmp.child('/').forEach(itemTp => {            \r\n            storeArray.push({'storeName': itemTmp.key, 'time': self.getTimeFromEpoch(itemTp.key), 'epoch': itemTp.key });\r\n            return false;\r\n          });\r\n          return false;\r\n        });\r\n        previousArray['store'] = storeArray;\r\n        self.previousListArray.push(previousArray);\r\n        console.log(self.previousListArray);\r\n        return false;\r\n      });\r\n\r\n      self.loading.dismiss();\r\n    });\r\n  }\r\n\r\n  getDateInFormat(date){\r\n    \r\n    var monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n      \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n    ];\r\n    let dt = date.split(\"_\");\r\n    let dtFmt = dt[2]+'/'+dt[1]+'/'+dt[0];\r\n    \r\n    let dtFormat = new Date(dtFmt);\r\n    return dt[0] + \" \" + monthNames[dtFormat.getMonth()]+ \" \"+ dt[2];\r\n  }\r\n\r\n  getItemPreviousTripByStore(date, store){\r\n    this.navCtrl.push('MyPreviousTripItemListPage', {dateValue: date.split('/').join('_'), storeName: store.storeName, time: store.epoch});  \r\n  }\r\n\r\n  getTimeFromEpoch(dateTime){\r\n      var date = new Date(0);\r\n      date.setUTCMilliseconds(dateTime);\r\n      let hrs = date.getHours();\r\n      let min = date.getMinutes();\r\n      return (hrs > 12) ? (hrs-12 + ':' + min +' PM') : (hrs + ':' + min +' AM');\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my-previous-trip/my-previous-trip.ts"],"sourceRoot":""}