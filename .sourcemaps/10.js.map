{"version":3,"sources":["../../src/pages/my-previous-trip/my-previous-trip.module.ts","../../src/pages/my-previous-trip/my-previous-trip.ts"],"names":[],"mappings":"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","file":"10.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MyPreviousTripPage } from './my-previous-trip';\n\n@NgModule({\n  declarations: [\n    MyPreviousTripPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MyPreviousTripPage),\n  ],\n})\nexport class MyPreviousTripPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my-previous-trip/my-previous-trip.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ActionSheetController, LoadingController } from 'ionic-angular';\n\nimport { AddShoppingPage } from \"../add-shopping/add-shopping\";\nimport { EditShoppingItemPage } from \"../edit-shopping-item/edit-shopping-item\";\nimport { ShoppingItem } from \"../../models/shopping-item/shopping-item.interface\";\nimport { } from \"../edit-shopping-item/edit-shopping-item\";\nimport { FirebaseListObservable, AngularFireDatabase, FirebaseObjectObservable } from 'angularfire2/database';\nimport { User } from 'firebase/app';\nimport { Subscription } from 'rxjs/Subscription';\nimport { AuthServiceProvider } from '../../providers/auth-service/auth-service';\nimport { DataServiceProvider } from '../../providers/data-service/data-service';\nimport { Store } from '../../models/store/store';\n\n/**\n * Generated class for the MyPreviousTripPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-my-previous-trip',\n  templateUrl: 'my-previous-trip.html',\n})\nexport class MyPreviousTripPage {\n  \n    shoppingListRef$: FirebaseListObservable<ShoppingItem[]>;\n    previousTripRef$: FirebaseListObservable<Store[]>;\n    public previousListArray: Array<any> = [];\n  \n    private authenticatedUser: User;\n    private authenticatedUser$: Subscription;\n    private loading;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, private db: AngularFireDatabase,\n    private actionSheetCntrl: ActionSheetController, private auth: AuthServiceProvider, private data: DataServiceProvider,\n    public loadingCtrl: LoadingController) {\n    \n    this.loading = this.loadingCtrl.create({\n      content: 'Please wait...'\n    });\n    this.loading.present();\n\n    try {\n      console.log(\"Came to nexttrip oninnit\");\n      this.authenticatedUser$ = this.auth.getAuthenticatedUser().subscribe((user: User) => {\n        this.authenticatedUser = user;\n        this.initFirebase();\n        console.log(`nexttrip got user1 ${this.authenticatedUser.uid}`);\n      })\n    } catch (e) {\n      // console.error(e);\n    }\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad MyPreviousTripPage');\n  }\n\n  initFirebase() {\n    let self = this;\n    this.previousTripRef$ = this.db.list(`/previoustrip/${this.authenticatedUser.uid}`);\n    this.previousTripRef$.$ref.once(\"value\", function (snapshot) {\n      snapshot.forEach(snaps => {\n        let previousArray = [];\n        previousArray['date'] = self.getDateInFormat(snaps.key);\n        let storeArray: Array<any> = [];\n        snaps.child('/').forEach(itemTmp => {          \n          itemTmp.child('/').forEach(itemTp => {            \n            storeArray.push({'storeName': itemTmp.key, 'time': self.getTimeFromEpoch(itemTp.key), 'epoch': itemTp.key });\n            return false;\n          });\n          return false;\n        });\n        previousArray['store'] = storeArray;\n        self.previousListArray.push(previousArray);\n        console.log(self.previousListArray);\n        return false;\n      });\n\n      self.loading.dismiss();\n    });\n  }\n\n  getDateInFormat(date){\n    \n    var monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n      \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n    ];\n    let dt = date.split(\"_\");\n    let dtFmt = dt[2]+'/'+dt[1]+'/'+dt[0];\n    \n    let dtFormat = new Date(dtFmt);\n    return dt[0] + \" \" + monthNames[dtFormat.getMonth()]+ \" \"+ dt[2];\n  }\n\n  getItemPreviousTripByStore(date, store){\n    this.navCtrl.push('MyPreviousTripItemListPage', {dateValue: date.split('/').join('_'), storeName: store.storeName, time: store.epoch});  \n  }\n\n  getTimeFromEpoch(dateTime){\n      var date = new Date(0);\n      date.setUTCMilliseconds(dateTime);\n      let hrs = date.getHours();\n      let min = date.getMinutes();\n      return (hrs > 12) ? (hrs-12 + ':' + min +' PM') : (hrs + ':' + min +' AM');\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my-previous-trip/my-previous-trip.ts"],"sourceRoot":""}